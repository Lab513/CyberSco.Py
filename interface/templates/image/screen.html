<!-- Panel for controlling the processing -->

<!-- inserted in index_folder.html -->

<div id='panel_connexion' hidden> </div>

<div class='screen_panel' >

    <!-- inserted image -->

    <img id="curr_cam_pic"  style="line-height : 20px;" ></img>

    {% include 'image/cursors.html' %}

    <div id='pos_prior' >

        <span> x: </span> <input id='xpos' > <span> µm </span>
        <span> y: </span> <input id='ypos' > <span> µm </span>

    </div>

    <!-- step x and y -->

    <div id='dxy' >
         <span id='dxy_name'> Δxy: </span> <input id='input_step_xy' > <span id='dxy_unit'> µm </span>
    </div>

    <!-- nb of cells -->

    <div id='panel_nb_cells' ></div>

    <!-- SNAP -->

    <button id='snap' class="btn btn-warning" > SNAP </button>

    <!-- Set the SC -->

    {% include 'snap/snap_select.html'  %}

    {% include 'snap/snap_panel.html' %}

    {% include 'snap/live_snap.html' %}

    <!-- mda repetition index -->

    {% include 'mda/curr_rep.html' %}

    {% include 'snap/snap_control.html' %}

    {% include 'dmd/dmd_panel.html' %}


</div>


<script>

    $(document).ready(function () {

      var drawer = new DrawerJs.Drawer(null, {
            texts: customLocalization,
            plugins: drawerPlugins,
            // defaultImageUrl: '/images/drawer.jpg',
            defaultActivePlugin : { name : 'Pencil', mode : 'lastUsed'},
        }, 500, 500);
        $('#canvas-editor').append( drawer.getHtml() );

        drawer.onInsert();

        $('#save_canvas').click( function(){

          var base64Output = drawer.api.getCanvasAsImage()                   // retrieve the image from the canvas
          socket.emit( 'name_img_mosaic', $('#name_img_mosaic').val() )      // name of the image
          setTimeout(function(){
              socket.emit( 'image_canvas', base64Output )                    // send the image to the server for saving it
           }, 100);

        })

        $('#test_DMD').click( function(){

           var currSetChan = $('#select_snap_setting_channel').val()         // setting channel for DMD
           var infos_dmd = image_test_DMD + '&' + currSetChan
           socket.emit( 'infos_DMD_test', infos_dmd )

        })

        var image_test_DMD = ''

        $('#curr_mask_name').change(function(){
              image_test_DMD = $(this).val()
              $('.editable-canvas-image').attr('src', 'static/dmd/' + image_test_DMD + '.png')
        })


    });

</script>


<script >

  $('#curr_cam_pic').attr('src', '/static/curr_pic/frame0.png' + '?'  + new Date().getTime())
  $(".screen_panel")
  $('#panel_nb_cells').hide()
  $('#canvas-editor').click(function(){

  })

</script>
